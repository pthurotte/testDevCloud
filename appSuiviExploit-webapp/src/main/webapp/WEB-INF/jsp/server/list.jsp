<%@ page language="java" contentType="text/html; charset=UTF-8"	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

<script type="text/javascript">
function doDelete(row_id) {
    // get the form values
        vUrl="server/"+row_id+"/delete";
        $.ajax({
        type: "POST",
        data: "_method=DELETE",
        url: vUrl,
        success: function(response){
    // we have the response
    		$('#'+row_id).fadeOut("slow");
        	//$('#'+row_id).remove();
        },
        error: function(e){
        alert('Error: ' + e);
        }
        });
        }
</script>

<div class="row">
	<div class="span12">
	
		<c:if test="${!empty listeServeur}">
			<table class="table">
				<tbody>
					<tr>
						<th>Nom serveur</th>
						<th>Ip serveur</th>
						<th>Suppression</th>
					</tr>
				</tbody>
				<c:forEach var="serveur" items="${listeServeur}">
					<tr id="${serveur.idx}">
						<spring:url var="editServeurUrl" value="/server/{number}/edit">
								<spring:param name="number" value="${serveur.idx}" />
						</spring:url>
						<td>
						<a href="${editServeurUrl}"><c:out value="${serveur.nom}" /></a>
						</td>
						<td>
						<c:out value="${serveur.ip}" />
						</td>
						<spring:url var="deleteServeurUrl" value="/server/{number}/delete">
								<spring:param name="number" value="${serveur.idx}" />
						</spring:url>
						<td>
						<a data-toggle="modal" class="btn btn-mini" href="#popupSupprimerServeur" onclick="$('#popupSupprimerServeur form').attr('action', '${deleteServeurUrl}');" title="Supprimer"><i class="icon-trash"></i></a>
						
						</td>
						
						<td>
						<a data-toggle="modal" class="btn btn-mini" href="" onclick="doDelete(${serveur.idx});" title="Supprimer"><i class="icon-trash"></i></a>
						
						</td>
					</tr>
				</c:forEach>
			</table>
		</c:if>
		
		<c:if test="${empty listeServeur}">
			<spring:message code="serveur.liste.vide"/>
		</c:if>
		
		<div id="popupSupprimerServeur" class="modal hide fade" style="display: none;">
			<div class="modal-header">
				<a class="close" data-dismiss="modal">Ã—</a>
				<h3>Etes-vous sur de vouloir supprimer ce serveur ?</h3>
			</div>
			<div class="modal-body">
				<form:form cssClass="form-horizontal" style="text-align:center;" action="" modelAttribute="serveurForm" method="DELETE">
					<button id="submit" name="submit" type="submit" class="btn">Oui</button>
						&nbsp;
					<a class="btn" href="#" data-dismiss="modal">Non</a>
				</form:form>
			</div>
		</div>
		
	</div>
</div>
